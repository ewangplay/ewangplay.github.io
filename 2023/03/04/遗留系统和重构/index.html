<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>遗留系统和重构 | 筒中窥猫</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">遗留系统和重构</h1><a id="logo" href="/.">筒中窥猫</a><p class="description">你不要看我说什么，你要看我做什么</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">遗留系统和重构</h1><div class="post-meta">Mar 4, 2023<span> | </span><span class="category"><a href="/category/敏捷开发/">敏捷开发</a></span></div><div class="post-content"><p>每当看到以前团队遗留系统中的乱糟糟的代码，就会有一种国骂的冲动。这算是什么软件开发人员？没有了解过基本的设计原则吗？没有学习过常见的设计模式吗？没有训练过基本的面向对象设计思想吗？不讲究封装，不讲究抽象，不讲究解耦，不讲究可复用性，一个大函数平铺直叙下来好几百行，什么逻辑都往里面塞，除了当时写的人外，谁能看的明白，谁能维护的了？</p>
<p>这也就不奇怪为什么后来的团队，总是倾向于把系统重写，而不是维护遗留系统了。因为重构的难度太大了，重构的代价相当于重新开发一套新的系统，为什么不把它重写呢？</p>
<p>一般来说，这样糟糕的系统大都是赶工赶出来的结果，常见于那些工期要求很紧的项目中。开发人员被项目工期追着跑，不管三七二十一，先把功能实现了再说，什么设计原则、设计模式、抽象和解耦，先不要跟我扯那个淡，没那个时间。</p>
<p>所以，代码写成这样，不完全是开发人员的责任，有项目成本的问题，有项目管理的问题，有项目周期的问题，有开发人员素质和经验的问题，多种因素叠加在一起，共同塑造出了一个糟糕透顶的烂系统。</p>
<p>这样的系统表面看起来运行正常、功能齐全，满足了当时客户的需求，项目完成后大家还开了一个庆功宴。只有开发人员自己明白，这个系统到底是怎么拼凑出来的！</p>
<p>使出了洪荒之力，终于把项目给应付过去了，那接着呢？噩梦才刚刚开始啊。还没有松口气，客户又提出了新的需求，接着改吧。项目经理觉得很奇怪，不就是改动一个小需求吗，你要做两周？不就是加一个模块吗，你要一个月？你是不是在磨洋工？！No！最多一周！好吧，那接着复制粘贴吧，重复的代码满天飞，再塞进去更多的业务逻辑，系统变得越来越复杂和不可维护。</p>
<p>当客户一次又一次提出新的需求时，开发人员已经准备跑路了，反正这坨屎一样的代码再跟我没关系了，谁能维护谁维护去吧，老子去也！</p>
<p>等系统变得不可维护，大家都束手无策，只能考虑重新开发时，上面的管理者往往把责任推给下面的开发人员，说他们不负责任，素质低下，技术糟糕，坑了我们坑了公司，却不反思是什么原因造成了这样的局面。为什么开发人员放弃自己的原则去胡乱拼凑代码？为什么明明需要三个月的开发量却压缩到一个月完成？为什么客户可以无休止地提出新的需求而不加以控制管理？开发人员是有责任，但他们的责任只是局部环节，不应该把整体的责任强加到他们身上。</p>
<p>无论如何，开发人员是有责任的。作为一个有责任的开发人员，要尽量把这种风险降低，而不是逆来顺受，管理者说什么就是什么，要有讨价还价的勇气和底气。要顶住压力，争取更多的时间去完善设计，尽可能地让代码符合设计之道，而不是破罐子破摔，反正已经这样了，随便造吧，造死拉倒！</p>
<p>作为直接参与过不少项目的开发人员，我是能够理解开发人员的处境的，也是能够理解开发人员这样写代码的动机的。有时候，为了图快，就顾不了那么多了！形势所迫，我难免也会这样做。但不同的是，每个开发人员针对重构的态度和技巧是各不相同的。我可以允许自己的代码在项目初期赶工期的时候设计差一些臃肿一些，但我不允许它们一直烂下去，我总会找机会把它们重构掉。</p>
<p>一个开发人员，应该把重构这件事当成吃饭睡觉一样平常自然，完全融入自己日常的工作中。这是一种态度，也是一种技能。一个团队能不能开发出好的产品，跟能不能重构、会不会重构有着莫大的关系。我告诉团队里面的开发人员，敏捷开发体现在方方面面，不只是看板才叫敏捷，不只是站立会议才叫敏捷，不只是用户故事才叫敏捷，不只是结对编程才叫敏捷，重构也叫敏捷，而且是敏捷很重要的一部分，我们应该大力提倡微重构。</p>
<p>什么是微重构？不要把重构想的那么高大上，非要斋戒沐浴才能开始重构？非要给你一个月空闲时间才能开始重构？非要学完了二十三种设计模式烂熟于胸了才能开始重构？重构随时都可以发起，花上十分钟就可以完成一次重构，在每天的开发任务中可以穿插进去很多轮的重构，为什么不可以呢？</p>
<p>把一个大函数分解成几个小函数，难道不叫重构？把一个胡乱命名的类名、函数名、变量名修改成一个自然达意的名称，难道不叫重构？把一个类按照单一职责原则重新做一下抽象，难道不叫重构？这样的重构能花费多长的时间？几分钟，十几分钟，或者半个小时。</p>
<p>每一次微重构，产品就往前优化了一小步，日积月累的微重构，产品就往前优化了一大步。不知不觉，我们的产品就旧貌换新颜，大为改观了。微重构的一小步，产品质量的一大步。</p>
<p>当然，重构不能是无源之水、无根之木，重构的思想和技巧不是无缘不顾就具备的，需要学习，需要实践，需要经历很多产品和项目的洗礼。</p>
<p>我有时候就有些自以为是，总是想责问年轻的开发人员为什么不按照这种设计思想去做开发，为什么不对这段代码进行一下重构，这难道不是很简单很明显的事情吗？但转念一想，才意识到自己犯了主观臆断的错误，有点把自己的思想和经历强加给他人了。我为什么是我，他又为什么是他？是什么塑造了我，又是什么塑造了他？我所看到的，不一定是他能够看到的；他所想的，也不一定是我能够理解的。一想到这点，我就稍微有点释然了，也就没那么愤懑了。每个人的修炼之路需要自己去完成。</p>
<p>关于设计和重构的书籍很多，每个人喜爱的也有所不同。我这里推荐几本作为参考吧：《重构：改善既有代码的设计》（Martin Flower）、《代码整洁之道》、《架构整洁之道》、《敏捷整洁之道》、《敏捷软件开发》。后面四本都是Robert C.Martin的书，他被业界尊称为Bob大叔，是我最喜爱的技术类作家之一，他的书引人入胜，思想深刻，值得一读再读。</p>
</div><div class="tags"><a href="/tag/重构/">重构</a></div><div class="post-nav"><a class="pre" href="/2023/12/02/缅怀芒格先生/">缅怀芒格先生</a><a class="next" href="/2022/12/15/我的新冠康复之旅/">我的新冠康复之旅</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://ewangplay.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/category/人生计划/">人生计划</a></li><li class="category-list-item"><a class="category-list-link" href="/category/人生随笔/">人生随笔</a></li><li class="category-list-item"><a class="category-list-link" href="/category/家庭教育/">家庭教育</a></li><li class="category-list-item"><a class="category-list-link" href="/category/工作思考/">工作思考</a></li><li class="category-list-item"><a class="category-list-link" href="/category/影视评论/">影视评论</a></li><li class="category-list-item"><a class="category-list-link" href="/category/技术记录/">技术记录</a></li><li class="category-list-item"><a class="category-list-link" href="/category/敏捷人生/">敏捷人生</a></li><li class="category-list-item"><a class="category-list-link" href="/category/敏捷开发/">敏捷开发</a></li><li class="category-list-item"><a class="category-list-link" href="/category/杂项/">杂项</a></li><li class="category-list-item"><a class="category-list-link" href="/category/架构设计/">架构设计</a></li><li class="category-list-item"><a class="category-list-link" href="/category/社会观察/">社会观察</a></li><li class="category-list-item"><a class="category-list-link" href="/category/编程技术/">编程技术</a></li><li class="category-list-item"><a class="category-list-link" href="/category/认知科学/">认知科学</a></li><li class="category-list-item"><a class="category-list-link" href="/category/读书/">读书</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tag/读书单/" style="font-size: 15px;">读书单</a> <a href="/tag/C/" style="font-size: 15px;">C++</a> <a href="/tag/FVWM/" style="font-size: 15px;">FVWM</a> <a href="/tag/Golang/" style="font-size: 15px;">Golang</a> <a href="/tag/并发/" style="font-size: 15px;">并发</a> <a href="/tag/学车/" style="font-size: 15px;">学车</a> <a href="/tag/阿伦森/" style="font-size: 15px;">阿伦森</a> <a href="/tag/社会心理学/" style="font-size: 15px;">社会心理学</a> <a href="/tag/分布式/" style="font-size: 15px;">分布式</a> <a href="/tag/编程道场/" style="font-size: 15px;">编程道场</a> <a href="/tag/人生感悟/" style="font-size: 15px;">人生感悟</a> <a href="/tag/个人博客/" style="font-size: 15px;">个人博客</a> <a href="/tag/Github/" style="font-size: 15px;">Github</a> <a href="/tag/fabric/" style="font-size: 15px;">fabric</a> <a href="/tag/游戏机制/" style="font-size: 15px;">游戏机制</a> <a href="/tag/如何学习/" style="font-size: 15px;">如何学习</a> <a href="/tag/教育/" style="font-size: 15px;">教育</a> <a href="/tag/末日穷途/" style="font-size: 15px;">末日穷途</a> <a href="/tag/生涯管理/" style="font-size: 15px;">生涯管理</a> <a href="/tag/微服务/" style="font-size: 15px;">微服务</a> <a href="/tag/少儿编程/" style="font-size: 15px;">少儿编程</a> <a href="/tag/scratch/" style="font-size: 15px;">scratch</a> <a href="/tag/程序员客栈/" style="font-size: 15px;">程序员客栈</a> <a href="/tag/百鸟朝凤/" style="font-size: 15px;">百鸟朝凤</a> <a href="/tag/知行合一/" style="font-size: 15px;">知行合一</a> <a href="/tag/游泳/" style="font-size: 15px;">游泳</a> <a href="/tag/Thrift/" style="font-size: 15px;">Thrift</a> <a href="/tag/奇特的一生/" style="font-size: 15px;">奇特的一生</a> <a href="/tag/学习之道/" style="font-size: 15px;">学习之道</a> <a href="/tag/我的团长我的团/" style="font-size: 15px;">我的团长我的团</a> <a href="/tag/枪炮病菌与钢铁/" style="font-size: 15px;">枪炮病菌与钢铁</a> <a href="/tag/第三种黑猩猩/" style="font-size: 15px;">第三种黑猩猩</a> <a href="/tag/巨人的陨落/" style="font-size: 15px;">巨人的陨落</a> <a href="/tag/阿甘正传/" style="font-size: 15px;">阿甘正传</a> <a href="/tag/叔本华/" style="font-size: 15px;">叔本华</a> <a href="/tag/论思考/" style="font-size: 15px;">论思考</a> <a href="/tag/未成年人犯罪/" style="font-size: 15px;">未成年人犯罪</a> <a href="/tag/辅导作业/" style="font-size: 15px;">辅导作业</a> <a href="/tag/埃博拉/" style="font-size: 15px;">埃博拉</a> <a href="/tag/血疫/" style="font-size: 15px;">血疫</a> <a href="/tag/如何思考/" style="font-size: 15px;">如何思考</a> <a href="/tag/快时代慢思考/" style="font-size: 15px;">快时代慢思考</a> <a href="/tag/年度总结/" style="font-size: 15px;">年度总结</a> <a href="/tag/年度计划/" style="font-size: 15px;">年度计划</a> <a href="/tag/职业生涯/" style="font-size: 15px;">职业生涯</a> <a href="/tag/士兵突击/" style="font-size: 15px;">士兵突击</a> <a href="/tag/指环王/" style="font-size: 15px;">指环王</a> <a href="/tag/极简主义/" style="font-size: 15px;">极简主义</a> <a href="/tag/围城/" style="font-size: 15px;">围城</a> <a href="/tag/工作环境/" style="font-size: 15px;">工作环境</a> <a href="/tag/写给孩子的信/" style="font-size: 15px;">写给孩子的信</a> <a href="/tag/工作感悟/" style="font-size: 15px;">工作感悟</a> <a href="/tag/学习计划/" style="font-size: 15px;">学习计划</a> <a href="/tag/罗辑思维/" style="font-size: 15px;">罗辑思维</a> <a href="/tag/跑步/" style="font-size: 15px;">跑步</a> <a href="/tag/孔子/" style="font-size: 15px;">孔子</a> <a href="/tag/倚天屠龙记/" style="font-size: 15px;">倚天屠龙记</a> <a href="/tag/张无忌/" style="font-size: 15px;">张无忌</a> <a href="/tag/个人成长/" style="font-size: 15px;">个人成长</a> <a href="/tag/游记/" style="font-size: 15px;">游记</a> <a href="/tag/时间管理/" style="font-size: 15px;">时间管理</a> <a href="/tag/卡拉马佐夫兄弟/" style="font-size: 15px;">卡拉马佐夫兄弟</a> <a href="/tag/陀思妥耶夫斯基/" style="font-size: 15px;">陀思妥耶夫斯基</a> <a href="/tag/罪与罚/" style="font-size: 15px;">罪与罚</a> <a href="/tag/当下/" style="font-size: 15px;">当下</a> <a href="/tag/尽人事/" style="font-size: 15px;">尽人事</a> <a href="/tag/听天命/" style="font-size: 15px;">听天命</a> <a href="/tag/像哲学家一样生活/" style="font-size: 15px;">像哲学家一样生活</a> <a href="/tag/斯多葛主义/" style="font-size: 15px;">斯多葛主义</a> <a href="/tag/敏捷教练/" style="font-size: 15px;">敏捷教练</a> <a href="/tag/活着/" style="font-size: 15px;">活着</a> <a href="/tag/张艺谋/" style="font-size: 15px;">张艺谋</a> <a href="/tag/立志/" style="font-size: 15px;">立志</a> <a href="/tag/阿德勒/" style="font-size: 15px;">阿德勒</a> <a href="/tag/个体心理学/" style="font-size: 15px;">个体心理学</a> <a href="/tag/被讨厌的勇气/" style="font-size: 15px;">被讨厌的勇气</a> <a href="/tag/物来顺应/" style="font-size: 15px;">物来顺应</a> <a href="/tag/加缪/" style="font-size: 15px;">加缪</a> <a href="/tag/局外人/" style="font-size: 15px;">局外人</a> <a href="/tag/天命/" style="font-size: 15px;">天命</a> <a href="/tag/生活记录/" style="font-size: 15px;">生活记录</a> <a href="/tag/朱熹/" style="font-size: 15px;">朱熹</a> <a href="/tag/季谦先生/" style="font-size: 15px;">季谦先生</a> <a href="/tag/毛姆/" style="font-size: 15px;">毛姆</a> <a href="/tag/人性的枷锁/" style="font-size: 15px;">人性的枷锁</a> <a href="/tag/母亲/" style="font-size: 15px;">母亲</a> <a href="/tag/春天/" style="font-size: 15px;">春天</a> <a href="/tag/精力管理/" style="font-size: 15px;">精力管理</a> <a href="/tag/芒格/" style="font-size: 15px;">芒格</a> <a href="/tag/图灵/" style="font-size: 15px;">图灵</a> <a href="/tag/重构/" style="font-size: 15px;">重构</a> <a href="/tag/小狗钱钱/" style="font-size: 15px;">小狗钱钱</a> <a href="/tag/理财/" style="font-size: 15px;">理财</a> <a href="/tag/投资/" style="font-size: 15px;">投资</a> <a href="/tag/认知失调/" style="font-size: 15px;">认知失调</a> <a href="/tag/从众/" style="font-size: 15px;">从众</a> <a href="/tag/快乐魔法/" style="font-size: 15px;">快乐魔法</a> <a href="/tag/源泉/" style="font-size: 15px;">源泉</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2024/03/21/快乐的魔法/">快乐的魔法</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/03/20/敏捷行为设计实验—00前奏曲/">敏捷行为设计实验—00前奏曲</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/03/19/敏捷是一种生活方式/">敏捷是一种生活方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/03/08/为什么尊主们有这样的魔力/">为什么尊主们有这样的魔力？</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/03/04/《模仿游戏》观影笔记/">《模仿游戏》观影笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/03/02/早春漫步遐想/">早春漫步遐想</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/12/17/《小狗钱钱》读书笔记/">《小狗钱钱》读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/12/02/缅怀芒格先生/">缅怀芒格先生</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/04/遗留系统和重构/">遗留系统和重构</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/15/我的新冠康复之旅/">我的新冠康复之旅</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">筒中窥猫.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>